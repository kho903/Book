# 빠른 CPU를 위한 설계 기법
## 클럭
1. 컴퓨터 부품들은 '클럭 신호'에 맞춰 일사불란하게 움직인다.
2. CPU는 '명령어 사이클'이라는 정해진 흐름에 맞춰 명령어들을 실행한다.
- 클럭 신호가 높아지면 CPU는 명령어 사이클을 더 빠르게 반복할 것이고, 다른 부품들도 그에 맞춰 더 빠르게 작동할 것이다. 실제로 클럭 속도가 높은 CPU는 성능이 좋다.
그래서 클럭 속도는 CPU 속도 단위로 간주되기도 한다.
- 클럭 속도는 헤르츠(Hz) 단위로 측정. 이는 1초에 클럭이 몇 번 반복되는지를 나타낸다. 4.9GHz인 경우 1초에 49억 (4.9 x 10^9)번 반복된다는 것을 의미.
    - CPU 클럭 속도를 보면 기본 클럭 속도, 최대 클럭 속도로 나뉜 것을 볼 수 있는데, 이처럼 CPU는 일정 속도를 유지하는 것이 아닌 고성능을 요하는 순간에는 순간적으로
      클럭 속도를 높이고, 유연하게 클럭 속도를 낮추기도 한다. 강제로 더 끌어올릴 수도 있는데, 이를 오버클럭킹이라고 한다.
- 클럭 속도를 무작정 높이면 무조건 CPU가 빨라지는 것은 아니고, 발열 문제가 심각해진다. 즉, 클럭 속도만으로 CPU의 성능을 올리는 것에는 한계가 있다.

## 코어와 멀티코어
- 클럭 속도를 높이는 방법 외에 CPU 성능을 높이는 방법에는 CPU의 코어와 스레드 수를 늘리는 방법이 있다. 
- 코어를 이해하려면 CPU 용어를 현대적으로 재해석해야 하는데, '명령어를 실행하는 부품'으로 알고 있던 CPU는 전통적인 관점에서 원칙적으로 하나만 존재했다.
하지만, 오늘날 CPU는 많은 기술적 발전을 거듭하였고, CPU 내부에는 '명령어를 실행하는 부품'을 얼마든지 만들 수 있게 되었다.
- 즉, 우리가 지금까지 알고 있던 '명령어를 실행하는 부품'은 오늘날 코어 라는 용어로 사용되고, CPU는 '명령어를 실행하는 부품'에서 '명령어를 실행하는 부품을
여러 개 모아 포함하는 부품'으로 확장되었다.
- 코어를 여러 개 포함하고 있는 CPU를 멀티코어 CPU 또는 멀티코어 프로세서라고 부른다. 코어 개수에 따라 싱글, 듀얼, 트리플, 쿼드 코어 등으로 나뉜다.
- 코어를 무작정 늘려도 CPU의 연산 속도가 코어 수에 비례해서 증가하지는 않는다. 코어마다 처리할 연산이 적절히 분배되지 않는다면 코어 수에 비례하여 연산 속도가
증가하지 않는다.
- 또한 처리하고자 하는 작업량보다 코어 수가 지나치게 많아도 성능에는 크게 영향이 없다. 중요한 것은 코어마다 처리할 명령어들을 얼마나 적절하게 분배하느냐이고 그에
따라서 연산 속도는 크게 달라진다.

## 스레드와 멀티스레드
- 스레드의 사전적 의미는 '실행 흐름의 단위'이다. CPU에서 사용되는 스레드와 프로그래밍에서 사용되는 스레드는 조금 다르다.
- 스레드에는 CPU에서 사용되는 하드웨어적 스레드가 있고, 프로그램에서 사용되는 소프트웨어적 스레드가 있다.

### 하드웨어적 스레드
- 스레드를 하드웨어적으로 정의하면 '하나의 코어가 동시에 처리하는 명령어 단위'를 의미.
- 지금까지 보았던 CPU는 1코어 1스레드 CPU였다. 즉, 명령어를 실행하는 부품이 하나 있고, 한 번에 하나씩 명령어를 실행하는 CPU였다.
- 반면, 여러 스레드를 지원하는 CPU는 하나의 코어로도 여러 개의 명령어를 동시에 실행 가능. 이를 멀티스레드 프로세서 또는 멀티스레드 CPU라고 한다.
- 멀티스레드아 함께 등장하는 하이퍼스레딩 이라는 용어는 인텔의 멀티스레드 기술을 의미하는데, 인텔이 자신들의 멀티스레딩 기술에 명칭을 부여한 것.

### 소프트웨어적 스레드
- 소프트웨어적 스레드는 '하나의 프로그램에서 독립적으로 실행되는 단위'이다. 보통 프로그래밍 언어, 운영체제 학습에서 말한다.
- 하나의 프로그램은 실행되는 과정에서 한 부분만 실행될 수도 있지만, 프로그램의 여러 부분이 동시에 실행될 수도 있다.
- 가령 여러 기능이 동시에 수행되길 원하면 기능들을 작동시키는 코드를 각각의 스레드로 만들어 동시에 실행할 수 있다. 프로그래밍 언어를 이용해 만들 수 있다.


- 정리하면 스레드의 하드웨어적 정의는 '하나의 코어가 동시에 처리하는 명령어 단위', 소프트웨어적 정의는 '하나의 프로그램에서 독립적으로 실행되는 단위'를 의미.
- 1코어 1스레드 CPU도 소프트웨어적 스레드를 수십 개 실행 가능. 따라서, 두 개의 용어를 구분하는 것이 좋다.

### 멀티스레드 프로세서
- 먼저, 소프트웨어적으로 정의된 스레드는 스레드, CPU에서 사용되는 스레드는 하드웨어 스레드로 지칭.
- 멀티스레드 프로세서는 하드웨어적 스레드로, 하나의 코어로 여러 명령어를 동시에 처리하는 CPU. 실제로 설계는 매우 복잡하지만, 핵심은 레지스터이다.
- 하나의 코어로 여러 명령어를 동시에 처리하도록 만들려면 프로그램 카운터, 스택 포인터, 데이터 버퍼 레지스터, 데이터 주소 레지스터와 같이 하나의 명령어를 처리하기 위해
꼭 필요한 레지스터를 여러 개 가지고 있으면 된다.
- 여러 레지스터를 레지스터 세트라 하자. 레지스터 세트가 한 개인 CPU는 한 개의 명령어를 처리하기 위한 정보들을 기억할 뿐이지만, 두 개인 CPU는 두 개의 명령어를
처리하기 위한 정보들을 기억 가능. 여기서, ALU와 두 개의 레지스터 세트에 저장된 명령어를 해석하고 실행하면 하나의 코어에서 두 개의 명령어가 동시에 실행됨.
- 히드웨어 스레드를 이용해 하나의 코어로도 여러 명령어를 동시에 처리할 수 있으나 메모리 속 프로그램 입장에선 '한 번에 하나의 명령어를 처리하는 CPU'나 다름없음.
그래서, 하드웨어 스레드를 논리 프로세서라고 부르기도 한다.


- 정리하자면 코어는 명령어를 실행할 수 있는 '하드웨어 부품', 스레드는 '명령어를 실행하는 단위', 멀티코어 프로세서는 '명령어를 실행할 수 있는 하드웨어 부품이 CPU
안에 두 개 이상 있는 CPU', 멀티스레드 프로세서는 '하나의 코어로 여러 개의 명령어를 동시에 실행할 수 있는 CPU'를 의미

## 키워드 정리
- 클럭 속도가 높은 CPU는 빠르게 작동.
- 코어란 CPU 내에서 명령어를 실행하는 부품.
- 멀티코어 프로세서란 여러 개의 코어를 포함하는 CPU.
- 스레드에는 하드웨어적 스레드와 소프트웨어적 스레드가 있다.
- 멀티스레드 프로세서란 하나의 코어로 여러 개의 명령어를 동시에 실행할 수 있는 CPU를 말함.

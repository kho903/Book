# 28. 인덱스 구조
- '색인'이라고도 불리는 인덱스는 데이터베이스 객체 중 하나.
- 테이블에서 인덱스를 작성 가능.

## 1. 인덱스
- 인덱스는 테이블에 붙여진 색인이라 할 수 있음. 역할은 검색속도의 향상. 여기서 '검색'이란 SELECT 명령에 WHERE 구로 조건을 지정하고 그에 일치하는 행을
찾는 일련의 과정. 검색은 탐색이라고도 함.
- 테이블에 인덱스가 지정되어 있으면 효율적으로 검색할 수 있으므로 WHERE로 조건이 지정된 SELECT 명령의 처리 속도가 향상됨.
- 책의 목차나 색인 역시 인덱스라고 생각하면 됨. 책안에 있는 특정한 부분을 찾고 싶은 경우, 본문을 처음부터 읽어나가기보다 목차나 색인을 참고해서 찾는 편이
효율적. 인덱스가 바로 이런 역할.
- 인덱스의 구조도 목차나 색인과 비슷. 제목, 키워드별 페이지가 적혀있듯, 데이터베이스의 인덱스에는 검색 시에 쓰이는 키워드와 대응하는 데이터 행의 장소가
지정되어 있음.
- 인덱스는 테이블과는 별개로 독립된 데이터베이스 객체로 작성됨. 하지만 인덱스만으로는 아무런 의미가 없다. 대부분의 데이터베이스에서는 테이블 삭제시 인덱스도
같이 삭제됨.

## 2. 검색에 사용하는 알고리즘
- 인덱스를 사용하면 효율적으로 검색하는 이유를 알아보자.
- 대량 데이터를 효율적으로 검색하는 방법에 관해서는 데이터 탐색, 검색 알고리즘 등으로 연구되어 왔다. 데이터베이스의 인덱스에 쓰이는 대표적인 검색
알고리즘으로는 '이진 트리(binary tree)'가 있으며, 그 다음으로 '해시'가 유명.
- 이진 트리는 정확히 말하면 탐색 방법보다 데이터 구조. 탐색 방법으로 말하면 '이진 탐색(binary search)'이 됨. 이진 탐색에서 검색하기 쉬운 구조로
한 것이 이진 트리.

### 풀 테이블 스캔 (full table scan)
- 인덱스가 지정되지 않은 테이블 검색시 풀 테이블 스캔이라 불리는 검색 방법 사용.
- 처리 방법은 단순한데, 테이블에 저장된 모든 값을 처음부터 차례대로 조사하는 방법. 아주 단순한 검색 방법으로, 행이 1000건이라면 최대 1000번 탐색.

### 이진 탐색 (binary search)
- 이진 탐색은 차례로 나열된 집합에 대해 유효한 검색 방법. 처음부터 순서대로 조사하는 것이 아닌 집합을 반으로 나누어 조사하는 검색 방법
- 예를 들어 1, 2, 3 ... 100 까지 차례로 있는 집합에서 30을 검색한다고 하자. 열 이름을 no라 하고 WHERE no = 30과 같은 조건을 지정한 상태.
- 100개 중에 시작으로 가운데 50을 지정. 50은 30보다 크므로 다음으로 1-50의 가운데인 25 지정 이후 25-50의 가운데 38 지정 25-38의 중간 32,
25-38의 중간 32, 25-32의 중간 29, 29-32의 중간 31, 29-31의 중간 30. 이러한 방식으로 30을 찾아나가는 것이다.
- 풀 테이블 스캔시 30번을 비교해야 했지만 8번만에 끝나 더 효율적. 
- 데이터 수가 많지 않아 큰 차이가 아닐 수 있지만 실제 데이터베이스에는 수만, 수천만 건의 행이 있어, 풀 테이블 스캔을 한다면 데이터 수에 비례해
비교횟수도 늘어남. 그에 비해 이진 탐색은 데이터 수가 배가 되어도 비교 횟수는 1회밖에 늘어나지 않는다. 이런 점에서 이진 탐색이 우위에 있는 것.
> 대량의 데이터를 검색할 때는 이진 탐색이 빠르다!

### 이진 트리 (binary tree)
- 이진 탐색은 고속으로 검색할 수 있는 탐색 방법이지만 데이터가 미리 정렬되어 있어야 함. 하지만 테이블 내 행을 언제나 정렬된 상태로 두는 것은 힘든 작업.
- 일반적으로는 테이블에 인덱스를 작성하면 테이블 데이터와 별개로 인덱스용 데이터가 저장장치에 만들어짐. 이때 이진 트리라는 데이터 구조로 작성됨.
- 트리는 노드(node)라는 구성 요소로 구성. 각 노드는 두 개의 가지로 나뉨. 두 개의 가지로 분기하는 구조라서 '이진 트리'리 불림.
- 검색은 이진 트리의 가지를 더듬어 가면서 행해진다. 이진 탐색에서는 가운데 값부터 검색하기 시작했다. 하지만 이진 트리의 경우에는 트리의 루트 노드부터
시작. 루트 노드는 트리의 맨 위에 있다.
- 검색 진행 방법은 이진 탐색과 거의 비슷. 원하는 수치와 비교해서 더 크면 오른쪽 가지를, 작으면 왼쪽의 가지를 조사해 나감. 이진 탐색의 경우는 오른쪽의
가운데, 왼쪽의 가운데 값을 계산해야 하지만, 이진 트리에서는 구조 자체가 검색하기 쉬우므로 가지를 따라 이동하기만 하면 됨.


## 3. 유일성
- 이진 트리의 구조를 살피다 보면, 같은 값을 가지는 노드가 여러 개 있을 때의 결과에 대한 의문이 생길 수 있음. 사실 이진 트리에서는 집합 내에 중복하는
값을 가질 수 없다. 즉, 노드의 가지는 큰 쪽과 작은 쪽의 두 가지로 나뉘며, 같은 값을 허용하기 위해서는 '같은'이라는 제 3의 가지를 가질 필요가 있음.
- 하지만, 이진 트리에서 '같은 값을 가지는 노드를 여러 개 만들 수 없다'라는 특성은 키에 대해 유일성을 가지게 할 경우에만 유용. 그래서 기본키 제약은
이진 트리로 인덱스를 작성하는 데이터베이스가 많다.
> 이진 트리에는 중복하는 값을 등록할 수 없다!

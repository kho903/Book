# 프로세스 제어 블록과 문맥 교환
## 1. 프로세스 제어 블록
- 프로세스 제어 블록 (PCB)은 프로세스를 실행하는 데 필요한 중요한 정보를 보관하는 자료구조. TCB(Task Control Block)이라고도 함
- 모든 프로세스는 고유의 프로세스 제어 블록을 가지며, 프로세스 생성 시 만들어지고, 실행 완료 시 폐기된다.

### 1.1 프로세스 제어 블록의 구성
#### 포인터
- 첫 번째 블록에 저장됨.
- 준비 상태나 대기 상태의 큐를 구현할 때 사용

#### 프로세스 상태
- 생성, 준비, 실행, 대기, 보류 준비, 보류 대기 등
- 프로세스의 현재 상태, 두 번째 블록에 저장됨.

#### 프로세스 구분자
- 운영체제 내에 있는 여러 프로세스를 구별하기 위한 구분자

#### 프로그램 카운터
- 다음에 실행될 명령어의 위치를 가리키는 프로그램 카운터 값 저장

#### 프로세스 우선순위
- 프로세스의 중요도가 각각 다름. 
- 사용자 프로세스보다 중요도가 큰 커널 프로세스는 우선순위가 높고, 사용자 프로세스끼리도 우선순위가 다름
- CPU 스케줄러가 준비 상태에 있는 프로세스 중 실행 상태로 옮겨야 할 프로세스를 선택할 때 기준으로 삼는다.

#### 각종 레지스터 정보
- 레지스터, 누산기, 색엔 레지스터, 스택 포인터와 같은 레지스터의 값이 저장됨
- 레지스터의 중간값 보관

#### 메모리 관리 정보
- 프로세스가 어디에 있는지 나타내는 메모리 위치 정보, 메모리 보호를 위해 사용하는 경계 레지스터 값과 한계 레지스터 값 등 저장

#### 할당된 자원 정보
- 프로세스를 실행하기 위해 사용하는 입출력 자원이나 오픈 파일 등에 대한 정보

#### 계정 정보
- 계정 번호, CPU 할당 시간, CPU 사용 시간 등

#### 부모 프로세스 구분자와 자식 프로세스 구분자
- 부모 프로세스를 가리키는 PPID (Parent PID)와 자식 프로세스를 가리키는 CPID (Child PID)의 정보 저장

### 1.2 포인터의 역할
- 프로세스 제어 블록의 맨 위에 위치
- 입출력이 완료되기를 기다리는 프로세스는 대기 상태로 모이는데, 하나로 모아 놓으면 관리하기 불편 -> 같은 입출력을 요구한 프로세스끼리 모아 놓음 (대기 큐)

## 2. 문맥 교환
### 2.1 문맥 교환의 의미
- 문맥 교환은 CPU를 차지하던 프로세스가 나가고 새로운 프로세스를 받아들이는 작업. 이 때 두 프로세스 제어 블록의 내용이 변경됨
- 실행 상태에서 나가는 프로세스 제어블록에는 지금까지의 작업내용 저장, 실행 상태로 들어오는 프로세스 제어블록의 내용으로 CPU가 다시 세팅됨

### 2.2 문맥 교환의 절차
- 실행 상태에 있는 프로세스 P1이 타임아웃이 되면 P1의 프로세스 제어 블록에 현재 작업 결과 저장, 준비 상태로 쫓겨남
- 준비 상태에 있던 프로세스 P2가 실행 상태로 가면 CPU의 레지스터가 P2의 프로세스 제어 블록 값으로 채워져 다음 작업

### 문맥 교환이 일어나는 경우는 다양
- 한 프로세스의 타임아웃
- 인터럽트가 걸렸을 때
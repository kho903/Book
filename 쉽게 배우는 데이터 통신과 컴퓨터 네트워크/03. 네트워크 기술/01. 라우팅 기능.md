# 3.1 라우팅 기능
- 네트워크 양단에 연결된 호스트들이 전송하는 데이터는 전송 경로 중간에 위치한 라우팅 시스템을 거침. 라우팅 시스템은 데이터를 최종 목적지까지 올바른 경로로 중개하는 교환(Switching) 기능 제공.
네트워크의 발전이 전화망에서 시작된 까닭에 데이터의 중개 기능을 의미하는 일부 용어에 교환이라는 표현이 굳어짐.
- 연결형 서비스를 제공하는 회선 교환 시스템은 아날로그 환경의 음성 전화 서비스를 통해 발전했으며, 고정 대역폭의 전송률을 지원하므로 네트워크의 구조가 상대적으로 단순.
- 반면, 비연결형 서비스를 제공하는 패킷 교환 시스템은 디지털 환경의 컴퓨터 네트워크를 통해 발전했으며, 가변 대역의 전송률을 지원해 네트워크 구조가 복잡.
- 이외에도 프레임 릴레이 방식이 있는데, 이는 데이터의 전송 속도를 향상시키는 기술.
- 회선 교환 (Context Switching) 시스템은 고정 대역으로 할당된 연결을 설정해 데이터 전송을 시작. 따라서 회선에 할당된 고정 크기의 안정적인 전송률로 데이터를 전송할 수 있으며, 연결이 유지되는
동안에는 다른 연결에서 이 대역 사용 불가. 데이터의 전송 경로가 연결 설정 과정에서 확정되므로 라우팅 등 작업이 상대적으로 쉬움.
- 대표적인 회선 교환 방식인 전화망에서 음성 전송은 안정적인 속도로 일정하게 상대방에게 전달될 수 있지만, 전송 대역이 낭비된다는 단점 존재. 회선 교환 시스템에서는 하나의 연결에 대해 전송되는 모든
데이터가 동일한 경로로 라우팅됨.
- 패킷 교환(Packet Switching) 시스템은 컴퓨터 네트워크 환경에서 주로 이용. 데이터를 미리 패킷 단위로 나누어 전송하므로 패킷을 기준으로 라우팅이 이루어짐.
- 패킷 교환 시스템은 데이터 전송을 위한 전용 대역을 따로 할당하지 않아 가변 크기의 전송률을 지원. 패킷 교환에는 모든 패킷의 경로를 일정하게 유지시키는 가상 회선(Virtual Circuit) 방식과
패킷들이 각각의 경로로 전송되는 데이터그램(Datagram) 방식이 있다.
> 인터넷을 사용할 때 네트워크의 부하 정도에 따라 전송 속도가 일정하지 않은 이유는 고정적인 전송 대역이 확보되지 않기 때문. 따라서 네트워크 사용량이 많아지면 전송 속도가 느려짐.

## 1. 라우팅 시스템
- 전송 선로로 데이터를 전송할 때 전용 회선을 이용하거나 교환 회선을 이용 가능. 전용 회선 방식에서는 송신 호스트와 수신 호스트가 전용으로 할당된 통신 선로로 데이터를 전송하지만, 교환 회선 방식
에서는 전송 선로 하나를 다수의 호스트가 공유함.
- 일반적으로 전화 서비스와 같은 아날로그 환경의 공중 전화망은 교환 회선 방식 사용. 교환 회선 방식을 이용해 데이터를 주고받으려면 중간에 위치한 교환 시스템의 중개가 필요. 네트워크 안에 있는
교환기와 전송 선로들은 바깥에 있는 호스트들이 데이터를 송수신하기 위해 공유하는 자원. 전송 선로는 광케이블 기술 등의 발전으로 물리적인 전송 대역 용량에 비례해 논리적인 다수의 연결 회선 지원.
- 어떤 경로가 더 나을지는 전송 시점의 네트워크 혼잡도 등 여러 요인에 따라 달라짐. 특정 전송 선로에 데이터가 집중되지 않으면서 효율적인 경로를 선택할 수 있도록 하는 것이 교환기의 중요한 역할.
- 교환 회선을 이용하는 방식은 데이터의 전송 경로와 관련해 크게 두 가지로 구분됨. 하나는 데이터를 전송하기 전에 통신 양단 사이에 고정된 연결 경로를 설정하는 회선 교환 방식이고, 다른 하나는 미리
연결을 설정하지 않고, 데이터를 패킷 단위로 나누어 전송하는 패킷 교환 방식. 이외에 메시지 교환이라는 중간 형태도 존재. 디지털 통신 환경을 지원하는 인터넷은 패킷 교환 방식의 네트워크에 해당.

### 회선 교환 (Circuit Switching)
- 회선 교환 방식은 통신하고자 하는 호스트가 데이터를 전송하기 전에 연결 경로를 미리 설정하는 방식. 연결 설정 과정에서 송수신 호스트 간의 경로가 결정되기 때문에 모든 데이터가 같은 경로로 전달됨.
- 회선 교환 방식에서는 고정 대역의 논리적인 전송 선로를 전용으로 할당받으므로, 안정적인 데이터 전송률을 지원.
- 회선 교환 방식에서는 데이터를 패킷 단위로 나누어 전송하지 않기 때문에 패킷이라는 용어를 사용하지 않음.

### 메시지 교환 (Message Switching)
- 메시지 교환 방식은 데이터를 전송하기 전에 경로를 설정하지 않고, 대신 전송하는 메시지의 헤더마다 목적지 주소를 표시하는 방식.
- 중간의 교환 시스템은 이전 교환 시스템에서 보낸 전체 메시지가 도착할 때까지 받은 메시지를 일시적으로 버퍼에 저장. 이후 모든 메시지가 도착하면 다음 교환 시스템으로 전달하는 방식을 사용하므로
데이터 전송이 교환기 단위로 이어짐. 따라서 메시지 교환 방식은 송신 호스트가 전송하는 전체 데이터가 하나의 단위로 교환 처리된다고 볼 수 있음.

### 패킷 교환 (Packet Switching)
- 패킷 교환 방식은 회선 교환과 메시지 교환의 장점을 모두 이용.
- 송신 호스트는 전송할 데이터를 패킷이라는 일정 크기로 나누어 전송하며, 원칙적으로 송수신 호스트 사이의 연결이 존재하지 않으므로 각 패킷은 독립적인 라우팅 과정을 거쳐 수신 호스트에 도착함.
- 다만, 패킷 교환 방식에서도 회선 교환 방식과 같은 논리적인 연결 설정 개념을 도입한 가상 회선 방식이 존재.
- 인터넷에서 사용하는 패킷 교환 시스템의 장점은 전송 대역의 효율적 이용. 호스트의 무제한 수용, 패킷에 우선순위 부여라는 세 가지로 요약 가능.

#### 전송 대역의 효율적 이용
- 여러 호스트에서 전송한 패킷들이 동적인 방식으로 전송 대역을 공유하기 때문에 전송 선로의 이용 효율을 극대화 가능.
- 이를 반대의 관점으로 보면, 회선 교환 시스템에서는 호스트 간 연결 시 전송 대역을 전용으로 할당해 해당 호스트들이 데이터를 전송하지 않더라도 다른 호스트는 이 전송 대역을 이용 불가.
- 결과적으로 회선 교환 시스템은 전송 선로 이용 면에서 비효율적.

#### 호스트의 무제한 수용
- 회선 교환 방식에서는 개별 연결 요청에 대해 고정 대역을 할당해 전송 대역이 부족하면 새로운 연결 설정 요청을 수용 불가. 즉, 모든 회선 연결에 할당된 대역의 합이 전체 네트워크의 전송 용량
초과 불가.
- 그러나, 패킷 교환 방식에서는 전송 대역이 부족해 연결 설정 요청을 수용하지 못하는 경우란 없다. 임의의 연결 요청에 고정 대역을 할당하지 않으므로 이론상 호스트를 무한히 수용 가능. 전송 대역을
사용하는 호스트의 수가 늘면 네트워크 혼잡도가 높아져 패킷의 전송 지연이 심화될 뿐임.

#### 패킷에 우선순위 부여
- 패킷 교환 방식을 이용하면 데이터의 전송 작업이 패킷 단위로 이루어져 패킷에 우선순위를 부여하기 편리.
- 즉, 특정 호스트가 전송하는 패킷들을 먼저 전송할 패킷과 나중에 전송해도 되는 패킷으로 구분해 선택적으로 우선순위를 부여할 수 있음.


- 패킷 교환 방식에도 단점 존재. 패킷을 전송하는 과정에서 회선 교환 방식에 비해 더 많은 지연 발생. 
- 예로, 전송 패킷을 라우터의 내부 버퍼에 보관하는 과정에서 지연이 생기고, 기타 여러 종류의 대기 큐를 거치는 과정에서 가변 지연이 생길 수 있음. 또한 각각의 전송 패킷이 독립적인 경로로 전달되므로,
패킷마다 전송에 걸리는 시간이 일정하지 않을 수 있음. 따라서, 전체 데이터의 전송 지연 시간은 가장 늦게 도착한 패킷의 전송 지연에 영향을 받음.
- 패킷별로 지연되는 정도를 나타내는 지연 분포의 형태도 가변적일 수 밖에 없는데, 이런 가변적인 전송 지연의 분포를 지터(Jitter)라고 함. 지터 분포는 멀티미디어 데이터와 같이 실시간으로 처리되는
응용 환경에서 중요함.
- 교환기에서 패킷 경로를 선택하는 방식은 두 가지. 호스트 사이의 전송 경로를 미리 고정하는 정적 경로(Static Routing)와 네트워크 혼잡도를 비롯한 주변 상황에 따라 전송 경로를 지속적으로
조정하는 동적 경로(Dynamic Routing)가 있음.

## 2. 패킷 교환
- 네트워크 계층의 가장 중요한 역할은 패킷의 전송 경로를 결정하는 것.
- 데이터를 패킷 교환 방식으로 전송하는 네트워크는 가상 회선과 데이터그램이라는 두 가지 전송 방식 지원.
- 가상 회선 방식에서는 데이터를 패킷 단위로 나누어 전송하지만 송수신 호스트 사이에 가상 연결을 지원하므로 모든 패킷의 전달 경로가 동일.
- 반면, 데이터그램 방식에서는 패킷의 경로 선택이 독립적으로 이루어짐.
- 가상 회선 방식은 연결형 서비스를 지원하며, 데이터그램은 비연결형 서비스를 지원함.

### 가상 회선 (Virtual Circuit)
- 일반적으로 가상 회선 방식은 연결형 서비스를 지원하기 위한 기능으로, 미리 설정된 논리적인 연결을 통해 전송되는 모든 패킷의 경로가 동일.
- 송수신 호스트 사이에 설정된 가상의 단일 파이프를 통해 송신 호스트가 입력단으로 패킷을 송신하고, 수신 호스트가 출력단에서 패킷을 수신.
- 따라서, 모든 패킷이 하나의 파이프로 표현되는 동일 경로로 전송되므로 패킷이 도착하는 순서와 보낸 순서와 같음. 여기서 파이프의 개념은 한 프로세스의 출력을 다른 프로세스의 입력으로 사용할 수
있도록 프로세스를 연결하는 논리적 통신 매체.
- 가상 회선 방식은 연결 설정 과정에서 만들어진 가상 회선을 통해 모든 패킷이 동일한 경로로 전송되는데 패킷의 도착 순서가 뒤바뀔 수 있음.
- 가상 회선 방식으로 패킷을 전송하는 원리는 용어에서 유추할 수 있듯 회선 교환 방식과 같은 연결형 서비스를 지원. 그러나 가상 회선 방식은 패킷 교환 방식을 기반으로 하므로 데이터의 전송 단위가
패킷 단위로 이루어지는 반면, 회선 교환 방식은 패킷 기능을 지원하지 않음. 이는 두 교환 방식을 구분하는 중요한 차이점.

### 데이터그램 (Datagram)
- 패킷 교환 방식에서 비연결형 서비스를 이용해 패킷을 독립적으로 전송하는 것을 데이터그램 방식이라 함. 데이터그램 방식은 패킷을 송신하기 전에 연결을 설정하는 과정이 없어, 미리 경로 할당 X.
- 따라서 전송되는 패킷들이 독립적인 경로로 전달됨. 일반적으로 데이터그램 방식은 전송할 정보의 양이 적거나 상대적으로 신뢰성이 중요하지 않은 환경에서 사용됨.
- 데이터그램 방식에서는 가상 회선 방식과 달리 데이터를 전송하기 전에 연결을 설정하지 않으므로, 송신 호스트가 전송한 패킷이 독립적으로 라우팅되는 것을 알 수 있음. 송신 호스트가 전송한 패킷은
출발한 순서와 무관하게 수신 호스트에 도착 가능.
- 각 전송 경로의 속도는 네트워크 혼잡도에 따라 가변적. 따라서 목적지에 도착하는 순서를 예측 불가하며 늦게 출발한 패킷에 먼저 도착할 수도 있음.
- 데이터그램 방식에서 데이터의 도착 순서가 바뀌는 것은 흔하게 벌어지는 현상으로, 수신 호스트에서 데이터의 순서를 바로잡는 기능 필요.

## 3. 프레임 릴레이 (Frame Relay)
- 패킷 교환 방식이 개발된 시점에는 원거리 디지털 통신 과정에서 지금보다 더 많은 전송 오류가 발생했음. 그래서 전송 패킷에 물리적인 전송 오류를 처리하기 위한 오버헤드 비트를 많이 추가했는데,
이런 패킷들을 처리하는 오류 처리 과정이 상당히 복잡했음. 또한 중간에 위치한 교환 시스템에서 오류를 검색하고 복구하는 기능도 필요했음.
- 이와 달리 현대의 네트워크는 물리적인 전송 오류가 발생할 확률이 매우 낮아 과거의 과도한 오류 제어 기능이 낭비 요소가 됨. 여러 계층에서 수행되는 복잡한 오류 제어 기능 중 중복되는 부분을 제거하면
패킷의 전송 속도를 높일 수 있음. 이처럼 낭비 요소를 제거해 데이터 전송 속도를 향상시키기 위해 프레임 릴레이 방식이 고안됨.
- 신뢰도가 높은 새로운 네트워크 환경이 갖춰짐에 따라 전송 오류 제어 기능을 더 효율적으로 처리하는 네트워크 프로토콜을 작성할 필요가 생김. 그 결과, 동일한 속도의 전송 매체로 고속 데이터 전송을
지원할 수 있도록 고안된 기술이 프레임 릴레이.
- 패킷 교환 방식에서는 중간 라우터를 거치는 과정에서 데이터 링크 계층의 기능이 개별적으로 수행되어 개별 링크에서 긍정 응답 프레임을 반복 교환함. 즉, 프레임 릴레이 방식보다 오류 제어가 과도함.
- 프레임 릴레이 방식에서는 각 라우터의 개별 연결을 의미하는 홉(Hop) 단위의 흐름 제어와 오류 제어 기능을 수행하지 않음. 따라서 데이터의 전송과 긍정 응답의 처리가 큰 흐름으로 이루어져, 전송 
패킷의 양이 반으로 줄어듦. 이처럼 오류 제어 기능을 단순화하는 작업만으로도 데이터 전송 효율을 크게 향상 가능.
- 프레임 릴레이는 한 호스트에서 수신한 프레임을 다른 호스트로 중개(Relay)하는 역할만 함. 중복되는 오류 복구나 흐름 제어 기능은 수행하지 않으므로 데이터 링크 계층의 기능을 단순하게 설계 가능.

